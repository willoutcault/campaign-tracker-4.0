{% extends "base.html" %}
{% block content %}
<h3>{{ 'Edit' if client else 'New' }} Client</h3>
<form method="post">
  <div class="mb-3">
    <label class="form-label">Name (also used as Pharma)</label>
    <input class="form-control" type="text" name="name" value="{{ client.name if client else '' }}" required>
    <div class="form-text">We'll auto-create a Pharma with this name if it doesn't exist.</div>
  </div>
  <div class="mb-3">
    <label class="form-label">Default Brands (comma-separated)</label>
    <input class="form-control" type="text" name="default_brands" placeholder="e.g., Dupixent, Keytruda, Cabometyx">
    <div class="form-text">These will be created under the Pharma if they don't already exist.</div>
  </div>
  <div class="mb-3">
    <label class="form-label">Notes</label>
    <textarea class="form-control" name="notes" rows="3">{{ client.notes if client else '' }}</textarea>
  </div>
  <button class="btn btn-primary">Save</button>
</form>

{% if client %}
<hr class="my-4">
<h5 class="mb-3">Mapped Brands under Pharma: {{ pharma_name or client.name }}</h5>
{% if mapped_brands and mapped_brands|length > 0 %}
  <table class="table table-sm table-striped">
    <thead><tr><th>#</th><th>Brand</th></tr></thead>
    <tbody>
      {% for b in mapped_brands %}
      <tr><td>{{ loop.index }}</td><td>{{ b.name }}</td></tr>
      {% endfor %}
    </tbody>
  </table>
{% else %}
  <div class="alert alert-info">No brands found yet for this Pharma. Add some in "Default Brands" and save.</div>
{% endif %}
{% endif %}
{% endblock %}
